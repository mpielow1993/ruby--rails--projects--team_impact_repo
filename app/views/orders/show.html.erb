<% @order_items.each do |order_item| %>
    <h3><%= order_item.store_item.name %></h3>
    <h3><%= order_item.store_item.price %></h3>
    
    <%= form_for order_item, url: member_order_order_item_path(@member, @order, order_item), method: :patch do |f| %>
        <%= f.hidden_field :store_item_id, value: order_item.store_item.id %>
        <%= f.number_field :quantity, value: order_item.quantity.to_i %>
        <%= f.submit "Update Cart", class: "btn btn-primary" %>
        <%= link_to "Remove Item", member_order_order_item_path(@member, @order, order_item), method: :delete, remote: true, class: "btn btn-danger" %>
    <% end %>
      
    <h3>Sub-Total: <%= order_item.sub_total %></h3>
<% end %>
<h2>Current Total: <%= @order.total %></h2>
<div id="order"><%= render 'orders/order', order: @order %></div>
  
<%= form_tag member_order_charges_path(@member, @order) do %>
  <article>
    <% if flash[:error].present? %>
      <div id="error_explanation">
        <p><%= flash[:error] %></p>
      </div>
    <% end %>
    <label class="amount">
      <span>Amount: &euro;<%= @order.total %></span>
    </label>
  </article>
  
    <button type="submit" class="btn btn-success">Checkout</button>
    <%= link_to "Continue Shopping", store_items_path, class: "btn btn-primary" %>
    <%= link_to "Delete Order", member_order_path(@member, @order), method: :delete, data: { confirm: "Are you sure you want to delete this order?" }, class: "btn btn-danger" %>

  <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
          data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
          data-description="order-id-<%= @order.id %>-member-id-<%= @member.id %>"
          data-amount="<%= (@order.total * 100).round  %>"
          data-locale="auto"></script>
<% end %>